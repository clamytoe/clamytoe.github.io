<meta property="og:title" content="Ramblings of an autodidact..." />
<meta property="og:type" content="website" />
<meta property="og:url" content="" />
<meta name="twitter:url" content="" />
<meta itemprop="name" content="Ramblings of an autodidact...">
<meta itemprop="url" content="">

<!DOCTYPE html>
<!--[if lt IE 7]>      <html lang="en" class="no-js lt-ie9 lt-ie8 lt-ie7" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/Blog"> <![endif]-->
<!--[if IE 7]>         <html lang="en" class="no-js lt-ie9 lt-ie8" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/Blog"> <![endif]-->
<!--[if IE 8]>         <html lang="en" class="no-js lt-ie9" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/Blog"> <![endif]-->
<!--[if gt IE 8]><!--> <html lang="en" class="no-js" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/Blog"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Cryptography</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<link rel="shortcut icon" href="/favicon.ico" type="image/vnd.microsoft.icon">
<meta name="author" content="Martin Uribe">
<meta name="copyright" content="Martin Uribe">
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@clamytoe" />
<meta property="og:site_name" content="Ramblings of an autodidact..." />
<meta property="og:title" content="Ramblings of an autodidact..." />
<meta property="og:type" content="website" />
<meta property="og:url" content="" />
<meta name="twitter:url" content="" />
<meta itemprop="name" content="Ramblings of an autodidact..." />
<meta itemprop="url" content=""/>
<meta property="og:description" content="A blog about programming, *nix, and software development." />
<meta name="twitter:description" content="A blog about programming, *nix, and software development." />
<meta itemprop="description" content="A blog about programming, *nix, and software development." />
<link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Ramblings of an autodidact... ATOM Feed"/>
<link href='//fonts.googleapis.com/css?family=Open+Sans:800italic' rel='stylesheet' type='text/css'>
<link href='//fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/uikit/2.23.0/css/uikit.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/uikit/2.23.0/css/components/search.min.css">
<link rel="stylesheet" href="/theme/css/tipuesearch.css">
<link rel="stylesheet" href="/theme/css/solarized.css">
<link rel="stylesheet" href="/theme/css/main.css">

<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
</head>
<body>
<!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

<header class=" mg-header uk-navbar uk-navbar-attached">

    <div class="uk-container uk-container-center">

        <a class="mg-brand uk-navbar-brand uk-hidden-small" href="">#! Ramblings of an autodidact...</a>
        <div class="mg-tagline uk-navbar-content uk-hidden-small">Random programming stuff</div>
        <a class="uk-navbar-toggle uk-visible-small" href="#mg-offcanvas" data-uk-offcanvas></a>
        <a class="mg-brand uk-navbar-brand uk-navbar-center uk-visible-small" href="">#! Ramblings of an autodidact...</a>

    </div>
</header>

<main class="mg-main">

<div class="uk-container uk-container-center">

    <div class="uk-grid" data-uk-grid-margin>

<div class="uk-width-medium-4-5">


            <article class="uk-article" itemtype="http://schema.org/BlogPosting" itemscope="itemscope" itemprop="blogPost">
                <a href="/pycryptodome.html" class="uk-article-title uk-link-muted" itemprop="name">Venture Into Cryptography with PyCryptodome!</a>
                <p class="uk-article-meta"><time datetime="2020-02-14" itemprop="datePublished">Fri 14 February 2020</time> â€¢ <a href="/category/cryptography.html">Cryptography</a></p>
</p>
                <p class="uk-article-lead" itemprop="description">learning about how to encrypt files</p>
                <section itemprop="articleBody"><h1>Into the cryptography rabbit hole!</h1>
<p>As dumb as it is, I have an unsecure text file that I use to keep track of all my username and passwords for all of the sites that I frequent. In order to not be so "hackable", I've decided to encrypt the file.</p>
<p>I had recently written a couple of coding challenges for <a href="https://codechalleng.es/">Pybites Code Challenges</a> site, using the <a href="https://cryptography.io/en/latest/">cryptography</a> module. One was a coding challenge and the other a testing one. Unfortunately, that module is <strong>NOT</strong> part of Python's Standard Library!</p>
<p>I didn't specifically install it, but it seems to come pre-installed with <a href="https://www.anaconda.com/distribution/">Anaconda</a>, which I use. I was looking through all of the modules that I had, when I came across the cryptography one. That's when I first got the idea for the challenges. It started as a single challenge, but I really liked how the tests came out and decided to split it up into coding and testing bites.</p>
<p>I pushed them to the Pybites Github private repo and it sat there for a bit before <a href="https://codechalleng.es/profiles/pybob">Bob Belderbos</a> decided to add them. Tha's when the problems started! He discovered that the module was not available so he installed it. It worked perfectly for the coding challenge, but for the testing one, when the call to the <a href="https://docs.pytest.org/en/latest/">Pytest</a>/<a href="https://github.com/mutpy/mutpy">Mutpy</a> instance is made, it loosed the path to the module!</p>
<p>We were discussing the issue on the <a href="https://pybit.es/pages/community.html">Pybites</a> Slack channel when <a href="https://codechalleng.es/profiles/driscollis">Mike Driscoll</a> the creator of <a href="http://www.blog.pythonlibrary.org/">The Mouse vs Python</a>, mentioned the <a href="https://www.pycryptodome.org/en/latest/">PyCryptodome</a> module. He initially thought that the problem was with installing the cryptography module. In the end, Bob was not able to figure out how to get it to work, so the challenge had to be removed from the platform.</p>
<p>Regardless, I was intrigued by pycryptodome, so I started to look into how it worked. It seemed pretty cool, so that's when I came up with the idea of encrypting my password file. It took a little bit of work, but I was able to encrypt the file into a binary. The problem came when I started to try and retrieve the data. The module complained about the data being too large!</p>
<p>I decided to create an encrypted binary for each entry. So far that's worked, but now I have to figure out how to scan the directory and list the ones that are available in order to be able to retrieve/update them. I've been using the logging module as well, so now I have to figure out how to do some log rotation to keep from taking up too much drive space. I might even play around with creating a UI for it, to make it easier to use.</p>
<p>Since I used my <a href="https://github.com/clamytoe/toepack">toepack</a> <a href="https://github.com/cookiecutter/cookiecutter">Cookiecutter</a> template, it's a package. It's gotten big enough that I've moved the two classes, (<code>Entry</code>, <code>Vault</code>) into their own files. It works out pretty good because the <code>app.py</code> file now only contains:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">.entry</span> <span class="kn">import</span> <span class="n">Entry</span>
<span class="kn">from</span> <span class="nn">.vault</span> <span class="kn">import</span> <span class="n">Vault</span><span class="p">,</span> <span class="n">logger</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Entering main.&quot;</span><span class="p">)</span>
    <span class="n">ip</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="s2">&quot;ip&quot;</span><span class="p">,</span> <span class="s2">&quot;http://192.168.2.1&quot;</span><span class="p">,</span> <span class="s2">&quot;admin&quot;</span><span class="p">,</span> <span class="s2">&quot;admin&quot;</span><span class="p">)</span>

    <span class="n">v</span> <span class="o">=</span> <span class="n">Vault</span><span class="p">()</span>
    <span class="n">v</span><span class="o">.</span><span class="n">encrypt_file</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
    <span class="n">v</span><span class="o">.</span><span class="n">decrypt_file</span><span class="p">(</span><span class="n">ip</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Running as a module.&quot;</span><span class="p">)</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>


<p>Seperating the code like this will come in handy when it comes to either creating a <a href="https://palletsprojects.com/p/click/">Click</a> CLI interface or a GUI one.</p>
<p>The results of encrypting that <code>Entity</code> object looks like this:</p>
<div class="highlight"><pre><span></span><code><span class="err">3ï¿½#4ï¿½ï¿½ï¿½ï¿½!ï¿½0/</span>
<span class="err">N9&quot;Lï¿½,Ø±Tï¿½o8aï¿½ï¿½ï¿½ï¿½ï¿½cHï¿½.</span>
<span class="err">Oï¿½ï¿½ï¿½}ï¿½wV&amp;ï¿½*umï¿½ï¿½Sï¿½MOï¿½7ï¿½`Óï¿½xZï¿½ ï¿½BDï¿½nï¿½z@fï¿½ueï¿½xï¿½Ú’ï¿½ï¿½ï¿½ï¿½cÕï¿½ï¿½ï¿½ï¿½ï¿½ï¿½2ï¿½ï¿½{MWï¿½5ï¿½ï¿½ï¿½ï¿½{ï¿½ï¿½jï¿½ï¿½ï¿½ï¿½ï¿½ï¿½36   ï¿½ï¿½ï¿½r    ~</span>
<span class="err">                         |ï¿½ï¿½Bzuï¿½5ï¿½ï¿½!a7Ü„o7h1ï¿½ï¿½ï¿½qkEï¿½Nï¿½</span>
<span class="err">ï¿½&amp;ï¿½Tï¿½*puM:ï¿½ï¿½U x&quot;&gt;ï¿½ï¿½Øª4%ï¿½ï¿½                           ï¿½Hï¿½ï¿½ï¿½ï¿½ï¿½Y6&gt;&lt;Q</span>
<span class="err">ï¿½ï¿½ï¿½ï¿½99ï¿½ï¿½ï¿½çŒ®Wï¿½ï¿½ï¿½&#39;ï¿½ï¿½uZ%$ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½%$ï¿½xï¿½ï¿½ef`ï¿½Ë²Dï¿½ï¿½iï¿½3ï¿½ï¿½ï¿½0ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½:</span>
<span class="err">ï¿½W&lt;ï¿½ï¿½ï¿½[ï¿½ï¿½ï¿½ï¿½ï¿½^ï¿½Îï¿½DGACqIï¿½Şï¿½ï¿½ï¿½7ï¿½ï¿½Åµï¿½|Dï¿½ï¿½Pï¿½_%ï¿½9ï¿½lIï¿½Öï¿½ï¿½ï¿½uï¿½ï¿½ï¿½ï¿½ï¿½_ ï¿½&quot;ï¿½ï¿½!ï¿½ï¿½ï¿½Pï¿½ï¿½ï¿½5ï¿½Pwï¿½M4ï¿½</span>
<span class="err">ï¿½Lï¿½ï¿½Pï¿½[ï¿½ï¿½Õœt9ï¿½ï¿½|rï¿½ ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Dï¿½ï¿½Uhï¿½ï¿½wï¿½ï¿½Û†ï¿½kH]Lï¿½~ï¿½ï¿½Dï¿½ï¿½ï¿½Ë¤ï¿½ó—£°Ó¦ï¿½ï¿½</span>
<span class="err">~xhï¿½lAï¿½dï¿½ï¿½Ù§ï¿½eÜï¿½                                           ï¿½S</span>
<span class="err">                  ï¿½Íšï¿½ï¿½mï¿½Qï¿½ï¿½&gt;ï¿½ï¿½ï¿½ï¿½{ï¿½    +ï¿½{&#39;?A-ï¿½ï¿½sï¿½ï¿½)ï¿½^İR%  </span>
</code></pre></div>


<p>The log file for that run looks like this:</p>
<div class="highlight"><pre><span></span><code><span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">812</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Creating</span><span class="w"> </span><span class="nl">vault</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">mohh</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="p">.</span><span class="n">passlock</span><span class="o">/</span><span class="n">ip</span><span class="p">.</span><span class="n">bin</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">812</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Importing</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="k">key</span><span class="err">:</span><span class="w"> </span><span class="n">plock</span><span class="p">.</span><span class="n">pub</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">812</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">Public</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="nl">accessed</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">mohh</span><span class="o">/</span><span class="p">.</span><span class="n">passlock</span><span class="o">/</span><span class="n">plock</span><span class="p">.</span><span class="n">pub</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">815</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Generating</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">session</span><span class="w"> </span><span class="k">key</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">815</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Generating</span><span class="w"> </span><span class="n">encrypted</span><span class="w"> </span><span class="k">session</span><span class="w"> </span><span class="k">key</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">819</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Generating</span><span class="w"> </span><span class="n">AES</span><span class="w"> </span><span class="n">cipher</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">820</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Encrypting</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="nc">text</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">820</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Writing</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="nc">text</span><span class="w"> </span><span class="k">to</span><span class="err">:</span><span class="w"> </span><span class="n">ip</span><span class="p">.</span><span class="n">bin</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">820</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">WARNING</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">mohh</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="p">.</span><span class="n">passlock</span><span class="o">/</span><span class="n">ip</span><span class="p">.</span><span class="n">bin</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="ow">exists</span><span class="err">!</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">820</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Successfully</span><span class="w"> </span><span class="n">wrote</span><span class="w"> </span><span class="k">to</span><span class="err">:</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">mohh</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="p">.</span><span class="n">passlock</span><span class="o">/</span><span class="n">ip</span><span class="p">.</span><span class="n">bin</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">821</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Opening</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nl">reading</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">mohh</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="p">.</span><span class="n">passlock</span><span class="o">/</span><span class="n">ip</span><span class="p">.</span><span class="n">bin</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">821</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Importing</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="k">key</span><span class="err">:</span><span class="w"> </span><span class="n">plock</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">821</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Private</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="nl">accessed</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">mohh</span><span class="o">/</span><span class="p">.</span><span class="n">passlock</span><span class="o">/</span><span class="n">plock</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">150</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Extracting</span><span class="w"> </span><span class="n">encrypted</span><span class="w"> </span><span class="k">session</span><span class="w"> </span><span class="k">key</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">151</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Generating</span><span class="w"> </span><span class="n">RSA</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">imported</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="k">key</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">151</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Decrypting</span><span class="w"> </span><span class="n">extracted</span><span class="w"> </span><span class="k">session</span><span class="w"> </span><span class="k">key</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">171</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">Session</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">successfully</span><span class="w"> </span><span class="n">restored</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">171</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Generating</span><span class="w"> </span><span class="n">AES</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="k">session</span><span class="w"> </span><span class="k">key</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">172</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Decrypting</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">verifying</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="nc">text</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">172</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nl">Closing</span><span class="p">:</span><span class="w"> </span><span class="n">ip</span><span class="p">.</span><span class="n">bin</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">172</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Generating</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Entry</span><span class="w"> </span><span class="k">object</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">decrypted</span><span class="w"> </span><span class="k">data</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">172</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Returning</span><span class="w"> </span><span class="n">decrypted</span><span class="w"> </span><span class="nc">text</span><span class="w"> </span><span class="k">for</span><span class="err">:</span><span class="w"> </span><span class="n">ip</span><span class="w"></span>
</code></pre></div>


<p>Not sure if that's too much information but logging each step in the process really comes in handy when trying to figure out issues at work. I've tried to keep all sensitive data out of it unless the logging is switched to <code>debug</code>.</p>
<p>Retrieving the encrypted data looks like this:</p>
<div class="highlight"><pre><span></span><code><span class="n">Successfully</span><span class="w"> </span><span class="nl">created</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">mohh</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="p">.</span><span class="n">passlock</span><span class="o">/</span><span class="n">ip</span><span class="p">.</span><span class="n">bin</span><span class="w"></span>

<span class="o">[</span><span class="n">ip</span><span class="o">]</span><span class="w"></span>
<span class="nl">INFO</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168.2.1</span><span class="w"></span>
<span class="k">USER</span><span class="err">:</span><span class="w"> </span><span class="k">admin</span><span class="w"></span>
<span class="nl">PASS</span><span class="p">:</span><span class="w"> </span><span class="k">admin</span><span class="w"></span>
</code></pre></div>


<blockquote>
<p><strong>NOTE</strong>: These are not real username and passwords!</p>
</blockquote></section>
                <a href="/pycryptodome.html#disqus_thread"></a>
                <hr class="uk-article-divider">
            </article>


</div>

        <div class="uk-width-medium-1-5 uk-hidden-small">

            <div class="uk-panel uk-panel-box">
                <form class="uk-search" action="search.html" data-uk-search>
                    <input class="uk-search-field tipue_search" type="search" name="q" id="tipue_search_input" autocomplete="off" placeholder="Search...">
                </form>
            </div>

            <div class="uk-panel uk-panel-box">
                <ul class="uk-nav uk-nav-side">
                    <li class="uk-nav-header">Categories</li>
                    <li class="uk-active"><a href="/category/cryptography.html">Cryptography</a></li>
                    <li ><a href="/category/datascience.html">DataScience</a></li>
                    <li ><a href="/category/general.html">General</a></li>
                    <li ><a href="/category/pytest.html">Pytest</a></li>
                    <li class="uk-nav-header">Pages</li>

                    <li >
                        <a href="/pages/about.html">About</a>
                    </li>


                    <li class="uk-nav-divider"></li>
                    <li ><a href="/archives.html">Archives</a></li>
                </ul>
            </div>

            <div class="uk-panel uk-panel-box">
                <h3 class="uk-panel-title">Receive Updates</h3>
                <a rel="alternate" type="application/atom+xml" href="/feeds/all.atom.xml" class="mg-feed"><i class="uk-icon-rss uk-icon-medium"></i> ATOM</a>
            </div>

            <div class="uk-panel uk-panel-box">
                <h3 class="uk-panel-title">Contacts</h3>
                <a class="mg-icon-link" href="https://twitter.com/clamytoe">
                    <i class="uk-icon-twitter uk-icon-medium"></i>
                </a>
                <a class="mg-icon-link" href="https://github.com/clamytoe">
                    <i class="uk-icon-github uk-icon-medium"></i>
                </a>
                <a class="mg-icon-link" href="https://www.linkedin.com/in/martin-uribe/">
                    <i class="uk-icon-linkedin uk-icon-medium"></i>
                </a>
            </div>

        </div>

    </div>

</div>

</main>

<footer class="mg-footer">
    <div class="uk-container uk-container-center uk-text-center">

        <div class="mg-icons-small uk-subnav uk-visible-small">
            <li><a rel="alternate" type="application/atom+xml" href="/feeds/all.atom.xml" class="uk-icon-button uk-icon-rss"></a></li>
            <li>
                <a href="https://twitter.com/clamytoe" class="uk-icon-button uk-icon-twitter"></a>
            </li>
            <li>
                <a href="https://github.com/clamytoe" class="uk-icon-button uk-icon-github"></a>
            </li>
            <li>
                <a href="https://www.linkedin.com/in/martin-uribe/" class="uk-icon-button uk-icon-linkedin"></a>
            </li>
        </div>

        <div class="mg-author uk-panel">
            <p>&copy; 2020 Martin Uribe. All rights reserved.<br>Code snippets in the pages are released under <a href="http://opensource.org/licenses/MIT" target="_blank">The MIT License</a>, unless otherwise specified.</p>

            <p>Powered by <a href="http://blog.getpelican.com">Pelican</a>.<br class="uk-visible-small"> Theme <a href="https://github.com/lucachr/pelican-mg">mg</a> by <a href="https://github.com/lucachr">Luca Chiricozzi</a>.</p>
        </div>
    </div>
</footer>

<div id="mg-offcanvas" class="uk-offcanvas">
    <div class="uk-offcanvas-bar">

        <form class="uk-search" action="search.html" data-uk-search>
            <input class="uk-search-field" type="search" name="q" id="tipue_search_input" autocomplete="off" placeholder="Search...">
        </form>

        <ul class="uk-nav uk-nav-offcanvas" data-uk-nav>
            <li class="uk-nav-header">Categories</li>
            <li class="uk-active"><a href="/category/cryptography.html">Cryptography</a></li>
            <li ><a href="/category/datascience.html">DataScience</a></li>
            <li ><a href="/category/general.html">General</a></li>
            <li ><a href="/category/pytest.html">Pytest</a></li>
            <li class="uk-nav-header">Pages</li>
            <li >
                <a href="/pages/about.html">About</a>
            </li>


            <li class="uk-nav-divider"></li>
            <li><a href="/">Archives</a></li>
        </ul>
    </div>
</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.10.2.min.js"><\/script>')</script>
<script src="//cdnjs.cloudflare.com/ajax/libs/uikit/2.23.0/js/uikit.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/uikit/2.23.0/js/components/search.min.js"></script>
<script src="/theme/js/tipuesearch_set.js"></script>
<script src="/theme/js/tipuesearch.js"></script>
<script src="/theme/js/jquery.sticky-kit.js"></script>
<script src="/theme/js/plugins.js"></script>
<script src="/theme/js/main-search.js"></script>



</body>
</html>

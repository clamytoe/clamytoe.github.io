<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Venture Into Cryptography with PyCryptodome!</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Ramblings of an autodidact... Atom Feed" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Ramblings of an autodidact...</a></h1>
                <nav><ul>
                    <li><a href="/pages/about.html">About</a></li>
                    <li class="active"><a href="/category/cryptography.html">Cryptography</a></li>
                    <li><a href="/category/general.html">general</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/pycryptodome.html" rel="bookmark"
           title="Permalink to Venture Into Cryptography with PyCryptodome!">Venture Into Cryptography with PyCryptodome!</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2020-02-14T07:00:00-06:00">
                Published: Fri 14 February 2020
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/martin-uribe.html">Martin Uribe</a>
        </address>
<p>In <a href="/category/cryptography.html">Cryptography</a>.</p>

</footer><!-- /.post-info -->      <h1>Into the cryptography rabbit hole!</h1>
<p>As dumb as it is, I have an unsecure text file that I use to keep track of all my username and passwords for all of the sites that I frequent. In order to not be so "hackable", I've decided to encrypt the file.</p>
<p>I had recently written a couple of coding challenges for <a href="https://codechalleng.es/">Pybites Code Challenges</a> site, using the <a href="https://cryptography.io/en/latest/">cryptography</a> module. One was a coding challenge and the other a testing one. Unfortunately, that module is <strong>NOT</strong> part of Python's Standard Library!</p>
<p>I didn't specifically install it, but it seems to come pre-installed with <a href="https://www.anaconda.com/distribution/">Anaconda</a>, which I use. I was looking through all of the modules that I had, when I came across the cryptography one. That's when I first got the idea for the challenges. It started as a single challenge, but I really liked how the tests came out and decided to split it up into coding and testing bites.</p>
<p>I pushed them to the Pybites Github private repo and it sat there for a bit before <a href="https://codechalleng.es/profiles/pybob">Bob Belderbos</a> decided to add them. Tha's when the problems started! He discovered that the module was not available so he installed it. It worked perfectly for the coding challenge, but for the testing one, when the call to the <a href="https://docs.pytest.org/en/latest/">Pytest</a>/<a href="https://github.com/mutpy/mutpy">Mutpy</a> instance is made, it loosed the path to the module!</p>
<p>We were discussing the issue on the <a href="https://pybit.es/pages/community.html">Pybites</a> Slack channel when <a href="https://codechalleng.es/profiles/driscollis">Mike Driscoll</a> the creator of <a href="http://www.blog.pythonlibrary.org/">The Mouse vs Python</a>, mentioned the <a href="https://www.pycryptodome.org/en/latest/">PyCryptodome</a> module. He initially thought that the problem was with installing the cryptography module. In the end, Bob was not able to figure out how to get it to work, so the challenge had to be removed from the platform.</p>
<p>Regardless, I was intrigued by pycryptodome, so I started to look into how it worked. It seemed pretty cool, so that's when I came up with the idea of encrypting my password file. It took a little bit of work, but I was able to encrypt the file into a binary. The problem came when I started to try and retrieve the data. The module complained about the data being too large!</p>
<p>I decided to create an encrypted binary for each entry. So far that's worked, but now I have to figure out how to scan the directory and list the ones that are available in order to be able to retrieve/update them. I've been using the logging module as well, so now I have to figure out how to do some log rotation to keep from taking up too much drive space. I might even play around with creating a UI for it, to make it easier to use.</p>
<p>Since I used my <a href="https://github.com/clamytoe/toepack">toepack</a> <a href="https://github.com/cookiecutter/cookiecutter">Cookiecutter</a> template, it's a package. It's gotten big enough that I've moved the two classes, (<code>Entry</code>, <code>Vault</code>) into their own files. It works out pretty good because the <code>app.py</code> file now only contains:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">.entry</span> <span class="kn">import</span> <span class="n">Entry</span>
<span class="kn">from</span> <span class="nn">.vault</span> <span class="kn">import</span> <span class="n">Vault</span><span class="p">,</span> <span class="n">logger</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Entering main.&quot;</span><span class="p">)</span>
    <span class="n">ip</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="s2">&quot;ip&quot;</span><span class="p">,</span> <span class="s2">&quot;http://192.168.2.1&quot;</span><span class="p">,</span> <span class="s2">&quot;admin&quot;</span><span class="p">,</span> <span class="s2">&quot;admin&quot;</span><span class="p">)</span>

    <span class="n">v</span> <span class="o">=</span> <span class="n">Vault</span><span class="p">()</span>
    <span class="n">v</span><span class="o">.</span><span class="n">encrypt_file</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
    <span class="n">v</span><span class="o">.</span><span class="n">decrypt_file</span><span class="p">(</span><span class="n">ip</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Running as a module.&quot;</span><span class="p">)</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>


<p>Seperating the code like this will come in handy when it comes to either creating a <a href="https://palletsprojects.com/p/click/">Click</a> CLI interface or a GUI one.</p>
<p>The results of encrypting that <code>Entity</code> object looks like this:</p>
<div class="highlight"><pre><span></span><code><span class="err">3ï¿½#4ï¿½ï¿½ï¿½ï¿½!ï¿½0/</span>
<span class="err">N9&quot;Lï¿½,Ø±Tï¿½o8aï¿½ï¿½ï¿½ï¿½ï¿½cHï¿½.</span>
<span class="err">Oï¿½ï¿½ï¿½}ï¿½wV&amp;ï¿½*umï¿½ï¿½Sï¿½MOï¿½7ï¿½`Óï¿½xZï¿½ ï¿½BDï¿½nï¿½z@fï¿½ueï¿½xï¿½Ú’ï¿½ï¿½ï¿½ï¿½cÕï¿½ï¿½ï¿½ï¿½ï¿½ï¿½2ï¿½ï¿½{MWï¿½5ï¿½ï¿½ï¿½ï¿½{ï¿½ï¿½jï¿½ï¿½ï¿½ï¿½ï¿½ï¿½36   ï¿½ï¿½ï¿½r    ~</span>
<span class="err">                         |ï¿½ï¿½Bzuï¿½5ï¿½ï¿½!a7Ü„o7h1ï¿½ï¿½ï¿½qkEï¿½Nï¿½</span>
<span class="err">ï¿½&amp;ï¿½Tï¿½*puM:ï¿½ï¿½U x&quot;&gt;ï¿½ï¿½Øª4%ï¿½ï¿½                           ï¿½Hï¿½ï¿½ï¿½ï¿½ï¿½Y6&gt;&lt;Q</span>
<span class="err">ï¿½ï¿½ï¿½ï¿½99ï¿½ï¿½ï¿½çŒ®Wï¿½ï¿½ï¿½&#39;ï¿½ï¿½uZ%$ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½%$ï¿½xï¿½ï¿½ef`ï¿½Ë²Dï¿½ï¿½iï¿½3ï¿½ï¿½ï¿½0ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½:</span>
<span class="err">ï¿½W&lt;ï¿½ï¿½ï¿½[ï¿½ï¿½ï¿½ï¿½ï¿½^ï¿½Îï¿½DGACqIï¿½Şï¿½ï¿½ï¿½7ï¿½ï¿½Åµï¿½|Dï¿½ï¿½Pï¿½_%ï¿½9ï¿½lIï¿½Öï¿½ï¿½ï¿½uï¿½ï¿½ï¿½ï¿½ï¿½_ ï¿½&quot;ï¿½ï¿½!ï¿½ï¿½ï¿½Pï¿½ï¿½ï¿½5ï¿½Pwï¿½M4ï¿½</span>
<span class="err">ï¿½Lï¿½ï¿½Pï¿½[ï¿½ï¿½Õœt9ï¿½ï¿½|rï¿½ ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Dï¿½ï¿½Uhï¿½ï¿½wï¿½ï¿½Û†ï¿½kH]Lï¿½~ï¿½ï¿½Dï¿½ï¿½ï¿½Ë¤ï¿½ó—£°Ó¦ï¿½ï¿½</span>
<span class="err">~xhï¿½lAï¿½dï¿½ï¿½Ù§ï¿½eÜï¿½                                           ï¿½S</span>
<span class="err">                  ï¿½Íšï¿½ï¿½mï¿½Qï¿½ï¿½&gt;ï¿½ï¿½ï¿½ï¿½{ï¿½    +ï¿½{&#39;?A-ï¿½ï¿½sï¿½ï¿½)ï¿½^İR%  </span>
</code></pre></div>


<p>The log file for that run looks like this:</p>
<div class="highlight"><pre><span></span><code><span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">812</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Creating</span><span class="w"> </span><span class="nl">vault</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">mohh</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="p">.</span><span class="n">passlock</span><span class="o">/</span><span class="n">ip</span><span class="p">.</span><span class="n">bin</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">812</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Importing</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="k">key</span><span class="err">:</span><span class="w"> </span><span class="n">plock</span><span class="p">.</span><span class="n">pub</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">812</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">Public</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="nl">accessed</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">mohh</span><span class="o">/</span><span class="p">.</span><span class="n">passlock</span><span class="o">/</span><span class="n">plock</span><span class="p">.</span><span class="n">pub</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">815</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Generating</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">session</span><span class="w"> </span><span class="k">key</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">815</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Generating</span><span class="w"> </span><span class="n">encrypted</span><span class="w"> </span><span class="k">session</span><span class="w"> </span><span class="k">key</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">819</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Generating</span><span class="w"> </span><span class="n">AES</span><span class="w"> </span><span class="n">cipher</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">820</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Encrypting</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="nc">text</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">820</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Writing</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="nc">text</span><span class="w"> </span><span class="k">to</span><span class="err">:</span><span class="w"> </span><span class="n">ip</span><span class="p">.</span><span class="n">bin</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">820</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">WARNING</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">mohh</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="p">.</span><span class="n">passlock</span><span class="o">/</span><span class="n">ip</span><span class="p">.</span><span class="n">bin</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="ow">exists</span><span class="err">!</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">820</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Successfully</span><span class="w"> </span><span class="n">wrote</span><span class="w"> </span><span class="k">to</span><span class="err">:</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">mohh</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="p">.</span><span class="n">passlock</span><span class="o">/</span><span class="n">ip</span><span class="p">.</span><span class="n">bin</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">821</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Opening</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nl">reading</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">mohh</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="p">.</span><span class="n">passlock</span><span class="o">/</span><span class="n">ip</span><span class="p">.</span><span class="n">bin</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">821</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Importing</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="k">key</span><span class="err">:</span><span class="w"> </span><span class="n">plock</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">821</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Private</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="nl">accessed</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">mohh</span><span class="o">/</span><span class="p">.</span><span class="n">passlock</span><span class="o">/</span><span class="n">plock</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">150</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Extracting</span><span class="w"> </span><span class="n">encrypted</span><span class="w"> </span><span class="k">session</span><span class="w"> </span><span class="k">key</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">151</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Generating</span><span class="w"> </span><span class="n">RSA</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">imported</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="k">key</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">151</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Decrypting</span><span class="w"> </span><span class="n">extracted</span><span class="w"> </span><span class="k">session</span><span class="w"> </span><span class="k">key</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">171</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">Session</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">successfully</span><span class="w"> </span><span class="n">restored</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">171</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Generating</span><span class="w"> </span><span class="n">AES</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="k">session</span><span class="w"> </span><span class="k">key</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">172</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Decrypting</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">verifying</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="nc">text</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">172</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nl">Closing</span><span class="p">:</span><span class="w"> </span><span class="n">ip</span><span class="p">.</span><span class="n">bin</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">172</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Generating</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Entry</span><span class="w"> </span><span class="k">object</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">decrypted</span><span class="w"> </span><span class="k">data</span><span class="w"></span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">13</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">172</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Returning</span><span class="w"> </span><span class="n">decrypted</span><span class="w"> </span><span class="nc">text</span><span class="w"> </span><span class="k">for</span><span class="err">:</span><span class="w"> </span><span class="n">ip</span><span class="w"></span>
</code></pre></div>


<p>Not sure if that's too much information but logging each step in the process really comes in handy when trying to figure out issues at work. I've tried to keep all sensitive data out of it unless the logging is switched to <code>debug</code>.</p>
<p>Retrieving the encrypted data looks like this:</p>
<div class="highlight"><pre><span></span><code><span class="n">Successfully</span><span class="w"> </span><span class="nl">created</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">mohh</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="p">.</span><span class="n">passlock</span><span class="o">/</span><span class="n">ip</span><span class="p">.</span><span class="n">bin</span><span class="w"></span>

<span class="o">[</span><span class="n">ip</span><span class="o">]</span><span class="w"></span>
<span class="nl">INFO</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168.2.1</span><span class="w"></span>
<span class="k">USER</span><span class="err">:</span><span class="w"> </span><span class="k">admin</span><span class="w"></span>
<span class="nl">PASS</span><span class="p">:</span><span class="w"> </span><span class="k">admin</span><span class="w"></span>
</code></pre></div>


<blockquote>
<p><strong>NOTE</strong>: This are not real username and passwords!</p>
</blockquote>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://github.com/clamytoe">github</a></li>
                            <li><a href="https://codechalleng.es/profiles/clamytoe">pybit.es</a></li>
                            <li><a href="https://pybit.es/author/martin-uribe.html">articles</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="https://www.linkedin.com/in/martin-uribe/">linkedin</a></li>
                            <li><a href="https://twitter.com/clamytoe">twitter</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>